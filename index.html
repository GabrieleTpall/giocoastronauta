<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Astronauta: Atterra sui Pianeti</title>
  <style>
    :root{
      --bg:#0b1220; /* deep space */
      --card:#111a2e;
      --muted:#92a3b5;
      --accent:#5ee2ff;
      --ok:#38d39f;
      --bad:#ff5c7a;
      --warning:#ffd166;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;background:radial-gradient(1200px 600px at 50% -100px,#16223a 0,#0b1220 60%);color:#e9f1ff;}
    .app{min-height:100dvh;display:flex;flex-direction:column;gap:10px;padding:12px;max-width:820px;margin:0 auto}

    header{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;border:1px solid #1d2a46;border-radius:16px;background:linear-gradient(180deg,#0f1830,#0b1326);box-shadow:0 8px 24px rgba(0,0,0,.25)}
    header h1{font-size:18px;margin:0;letter-spacing:.3px}
    header small{color:var(--muted)}

    .layout{display:grid;gap:12px}
    /* Mobile-first: single column sections stacked */
    .section{background:linear-gradient(180deg,#0f1832,#0b1428);border:1px solid #182649;border-radius:18px;padding:12px;box-shadow:0 10px 24px rgba(0,0,0,.2)}
    .section h2{font-size:16px;margin:0 0 8px 0;color:#dbeafe}
    .hint{color:var(--muted);font-size:13px}

    /* Astronaut panel fixed height so it stays visible */
    .astro-wrap{display:grid;grid-template-columns:1fr;gap:8px;align-items:center}
    .astro-stage{height:220px;border-radius:16px;background:linear-gradient(180deg,#09101f 0,#0c152b 100%);border:1px solid #1d2a46;position:relative;overflow:hidden}
    .ground{position:absolute;left:0;right:0;bottom:0;height:48px;background:linear-gradient(180deg,#24334e,#1a2742);border-top:1px solid #2a3f6a}
    .astro-svg{position:absolute;inset:0;display:flex;align-items:flex-end;justify-content:center;}
    .astro-svg svg{width:160px;height:auto;transition:transform .5s ease}
    .astro-status{display:flex;align-items:center;gap:8px;font-size:14px}
    .status-dot{width:10px;height:10px;border-radius:999px}

    /* Planet chooser */
    .planet-list{display:flex;gap:8px;overflow:auto;scroll-snap-type:x mandatory;padding-bottom:4px}
    .chip{scroll-snap-align:start;flex:0 0 auto;padding:10px 12px;border-radius:999px;border:1px solid #28406e;background:#0f1a33;color:#dbeafe;font-size:14px;white-space:nowrap;cursor:pointer;transition:.2s}
    .chip:hover{transform:translateY(-1px)}
    .chip[aria-pressed="true"],.chip.active{background:linear-gradient(180deg,#163161,#0f2347);border-color:#3f6bbb;box-shadow:inset 0 0 0 1px #5988d6}

    /* Planet facts */
    .facts{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}
    .fact{background:#0e1a34;border:1px solid #21355e;padding:8px;border-radius:12px;font-size:12px;color:#cfe2ff}
    .fact b{display:block;color:#9dd4ff;font-size:11px;margin-bottom:2px;font-weight:600}

    /* Equipment grid */
    .equip-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .equip{border:1px solid #243b66;background:#0f1a34;border-radius:14px;padding:10px}
    .equip h3{margin:0 0 6px 0;font-size:14px;color:#dbeafe}
    .opt{display:flex;align-items:center;gap:8px;margin:6px 0}
    .opt input{width:18px;height:18px}
    .opt label{font-size:13px}

    .actions{display:flex;gap:8px}
    button.primary{flex:1;padding:12px;border-radius:12px;border:1px solid #316aa0;background:linear-gradient(180deg,#1a84c6,#17639a);color:#fff;font-weight:700;letter-spacing:.2px}
    button.secondary{padding:12px;border-radius:12px;border:1px solid #2a426e;background:#112147;color:#d9ecff}

    .result{margin-top:8px;padding:10px;border-radius:12px;border:1px solid #2a3f6a;display:none}
    .result.ok{background:rgba(56,211,159,.14);border-color:#2a8c6c}
    .result.bad{background:rgba(255,92,122,.12);border-color:#a33c52}

    .skull{width:28px;height:28px}

    /* Animations */
    .fall{transform:translateY(40px) rotate(18deg)}
    .stand{transform:translateY(0) rotate(0)}

    /* Larger phones/tablets */
    @media (min-width:640px){
      .layout{grid-template-columns:1fr 1fr;align-items:start}
      .astro-wrap{grid-column:1 / -1}
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Gioco astronauta: atterraggio sui pianeti">
    <header>
      <h1>Atterra sui Pianeti</h1>
      <small>Seleziona pianeta → equipaggiamento → prova</small>
    </header>

    <!-- Astronaut always visible -->
    <section class="section astro-wrap" aria-live="polite">
      <h2>Astronauta</h2>
      <div class="astro-stage" id="stage">
        <div class="astro-svg">
          <!-- SVG cartoon astronaut with slots for gear highlights -->
          <svg viewBox="0 0 180 220" aria-label="Astronauta">
            <!-- shadow -->
            <ellipse cx="90" cy="200" rx="28" ry="6" fill="#0b0f1a" opacity="0.6"></ellipse>
            <!-- boots -->
            <g id="boots" fill="#9aa8c2">
              <rect x="65" y="175" width="18" height="14" rx="4"/>
              <rect x="98" y="175" width="18" height="14" rx="4"/>
            </g>
            <!-- legs -->
            <g fill="#c7d3ea">
              <rect x="70" y="140" width="14" height="40" rx="7"/>
              <rect x="96" y="140" width="14" height="40" rx="7"/>
            </g>
            <!-- torso -->
            <rect x="60" y="95" width="60" height="55" rx="12" fill="#d8e4f8" stroke="#aebedd" stroke-width="2"/>
            <!-- control panel -->
            <rect x="72" y="105" width="36" height="24" rx="4" fill="#273b63" stroke="#3f5e98" stroke-width="2"/>
            <circle cx="82" cy="117" r="3" fill="#5ee2ff"/>
            <rect x="90" y="114" width="16" height="6" rx="2" fill="#ffcd6b"/>
            <!-- arms -->
            <g fill="#cfdbf3">
              <rect x="40" y="105" width="22" height="12" rx="6"/>
              <rect x="118" y="105" width="22" height="12" rx="6"/>
              <rect x="40" y="115" width="14" height="26" rx="7"/>
              <rect x="126" y="115" width="14" height="26" rx="7"/>
            </g>
            <!-- gloves -->
            <g id="gloves" fill="#9fb2d6">
              <circle cx="47" cy="145" r="8"/>
              <circle cx="133" cy="145" r="8"/>
            </g>
            <!-- helmet ring -->
            <ellipse cx="90" cy="90" rx="34" ry="12" fill="#aebedd"/>
            <!-- helmet dome -->
            <g id="helmet">
              <circle cx="90" cy="70" r="40" fill="#1b2744" stroke="#99a7c3" stroke-width="4"/>
              <circle cx="75" cy="58" r="6" fill="#2a3f6a"/>
              <circle cx="105" cy="62" r="9" fill="#2a3f6a"/>
              <rect x="66" y="36" width="48" height="16" rx="8" fill="#24365d" opacity=".7"/>
            </g>
            <!-- oxygen tank -->
            <g id="tank" transform="translate(46,104)">
              <rect x="0" y="0" width="20" height="36" rx="8" fill="#7ba3d9" stroke="#4d74aa" stroke-width="2"/>
              <rect x="68" y="0" width="20" height="36" rx="8" fill="#7ba3d9" stroke="#4d74aa" stroke-width="2"/>
              <rect x="18" y="-6" width="52" height="10" rx="4" fill="#4d74aa"/>
            </g>
            <!-- add-on overlays, toggled by classes -->
            <g id="shield" opacity="0">
              <circle cx="90" cy="70" r="48" fill="url(#gradShield)"/>
            </g>
            <defs>
              <radialGradient id="gradShield" cx="50%" cy="50%" r="50%">
                <stop offset="0%" stop-color="#5ee2ff" stop-opacity=".35"/>
                <stop offset="100%" stop-color="#5ee2ff" stop-opacity="0"/>
              </radialGradient>
            </defs>
          </svg>
        </div>
        <div class="ground"></div>
      </div>
      <div class="astro-status"><span class="status-dot" id="statusDot" style="background:var(--warning)"></span><span id="statusText">Seleziona un pianeta, poi scegli l'equipaggiamento.</span></div>
    </section>

    <!-- Planet choice first -->
    <section class="section" id="planetSection">
      <h2>1) Scegli il pianeta</h2>
      <div class="planet-list" id="planetList" role="tablist" aria-label="Pianeti del Sistema Solare"></div>
      <div class="facts" id="facts"></div>
      <p class="hint">Dati realistici semplificati: gravità, atmosfera, temperatura, meteo e pressione.</p>
    </section>

    <!-- Equipment second -->
    <section class="section" id="equipSection" aria-disabled="true">
      <h2>2) Seleziona l'equipaggiamento</h2>
      <div class="equip-grid">
        <div class="equip">
          <h3>Tuta & Ambiente</h3>
          <div class="opt"><input type="checkbox" id="pressLow"><label for="pressLow">Tuta pressurizzata (bassa, ~0.7 bar)</label></div>
          <div class="opt"><input type="checkbox" id="pressMed"><label for="pressMed">Tuta pressurizzata (media, ~1 bar)</label></div>
          <div class="opt"><input type="checkbox" id="pressHigh"><label for="pressHigh">Tuta alta pressione (fino a 90 bar)</label></div>
          <div class="opt"><input type="checkbox" id="cool"><label for="cool">Sistema raffreddamento</label></div>
          <div class="opt"><input type="checkbox" id="heat"><label for="heat">Sistema riscaldamento</label></div>
          <div class="opt"><input type="checkbox" id="acid"><label for="acid">Rivestimento anti-acido</label></div>
          <div class="opt"><input type="checkbox" id="dust"><label for="dust">Filtri anti-polvere / guarnizioni</label></div>
          <div class="opt"><input type="checkbox" id="rad"><label for="rad">Schermo anti-radiazioni</label></div>
          <div class="opt"><input type="checkbox" id="o2"><label for="o2">Riserva O₂ estesa</label></div>
        </div>
        <div class="equip">
          <h3>Atterraggio</h3>
          <div class="opt"><input type="checkbox" id="heatshield"><label for="heatshield">Scudo termico</label></div>
          <div class="opt"><input type="checkbox" id="parachute"><label for="parachute">Paracadute</label></div>
          <div class="opt"><input type="checkbox" id="retro"><label for="retro">Retrorazzi</label></div>
          <div class="opt"><input type="checkbox" id="landingLegs"><label for="landingLegs">Gambe d'atterraggio rinforzate</label></div>
          <div class="opt"><input type="checkbox" id="float"><label for="float">Modulo flottante/hover (gas giganti)</label></div>
        </div>
      </div>
      <div class="actions" style="margin-top:10px">
        <button class="primary" id="btnTest" disabled>Prova atterraggio</button>
        <button class="secondary" id="btnReset">Reset</button>
      </div>
      <div id="result" class="result" role="alert"></div>
    </section>
  </div>

  <script>
    // --- Planet database (realistic but simplified) ---
    const planets = [
      {
        id:"mercury", name:"Mercurio", emoji:"☿", g:"0.38 g", temp:"-170 / +430 °C", atm:"Quasi nulla", pressure:"≈0 bar", wind:"N/A",
        facts:["Giorno lunghissimo, notti gelide.","Escursione termica estrema."],
        requires:{heatshield:true, retro:true, landingLegs:true, suit:["pressMed"], env:["heat","cool","o2","rad"]}
      },
      { id:"venus", name:"Venere", emoji:"♀", g:"0.9 g", temp:"≈ +470 °C", atm:"CO₂ densa, acido solforico", pressure:"≈92 bar", wind:"Venti forti in quota",
        facts:["Temperatura e pressione estreme.","Nubi acide."],
        requires:{heatshield:true, parachute:true, retro:true, landingLegs:true, suit:["pressHigh","cool"], env:["acid","o2","rad"]}
      },
      { id:"earth", name:"Terra", emoji:"🌍", g:"1 g", temp:"-50 / +50 °C", atm:"Azoto/Ossigeno", pressure:"1 bar", wind:"Variabile",
        facts:["Casa dolce casa.","Serve equipaggiamento base."],
        requires:{landingLegs:true, suit:["pressLow"], env:[]}
      },
      { id:"moon", name:"Luna", emoji:"🌙", g:"0.16 g", temp:"-170 / +120 °C", atm:"Nessuna", pressure:"0 bar", wind:"N/A",
        facts:["Polvere regolite molto fine.","Forti sbalzi termici."],
        requires:{retro:true, landingLegs:true, suit:["pressMed"], env:["dust","heat","cool","o2","rad"]}
      },
      { id:"mars", name:"Marte", emoji:"♂", g:"0.38 g", temp:"-125 / +20 °C", atm:"CO₂ sottile", pressure:"0.006 bar", wind:"Tempeste di polvere",
        facts:["Atmosfera rarefatta.","Polvere ovunque."],
        requires:{heatshield:true, parachute:true, retro:true, landingLegs:true, suit:["pressMed"], env:["dust","heat","o2","rad"]}
      },
      { id:"jupiter", name:"Giove", emoji:"♃", g:"2.5 g (alta)", temp:"-145 °C in quota", atm:"H₂/He", pressure:"Crescente in profondità", wind:"Cicloni giganti",
        facts:["Nessuna superficie solida.","Solo piattaforme flottanti in quota."],
        requires:{heatshield:true, parachute:true, float:true, suit:["pressMed"], env:["heat","o2","rad"]}
      },
      { id:"saturn", name:"Saturno", emoji:"♄", g:"1.07 g (in quota)", temp:"≈ -140 °C", atm:"H₂/He", pressure:"Crescente", wind:"Venti forti",
        facts:["Anche qui nessuna superficie.","Atterraggio su piattaforma flottante."],
        requires:{heatshield:true, parachute:true, float:true, suit:["pressMed"], env:["heat","o2","rad"]}
      },
      { id:"uranus", name:"Urano", emoji:"♅", g:"0.89 g", temp:"≈ -200 °C", atm:"H₂/He/CH₄", pressure:"Crescente", wind:"Venti supersonici",
        facts:["Freddo estremo.","Piattaforma in atmosfera superiore."],
        requires:{heatshield:true, parachute:true, float:true, suit:["pressMed"], env:["heat","o2","rad"]}
      },
      { id:"neptune", name:"Nettuno", emoji:"♆", g:"1.14 g", temp:"≈ -200 °C", atm:"H₂/He/CH₄", pressure:"Crescente", wind:"Venti > 1500 km/h",
        facts:["Venti più veloci del Sistema Solare.","Solo modulo flottante in alta quota."],
        requires:{heatshield:true, parachute:true, float:true, suit:["pressMed"], env:["heat","o2","rad"]}
      }
    ];

    // --- UI refs ---
    const planetList = document.getElementById('planetList');
    const factsBox = document.getElementById('facts');
    const equipSection = document.getElementById('equipSection');
    const btnTest = document.getElementById('btnTest');
    const btnReset = document.getElementById('btnReset');
    const resultBox = document.getElementById('result');
    const stage = document.getElementById('stage');
    const statusDot = document.getElementById('statusDot');
    const statusText = document.getElementById('statusText');
    const helmetShield = document.getElementById('shield');

    let selectedPlanet = null;

    // Create planet chips
    planets.forEach(p=>{
      const chip = document.createElement('button');
      chip.className = 'chip';
      chip.setAttribute('aria-pressed','false');
      chip.innerHTML = `${p.emoji} ${p.name}`;
      chip.addEventListener('click',()=>selectPlanet(p.id));
      planetList.appendChild(chip);
    });

    function selectPlanet(id){
      selectedPlanet = planets.find(x=>x.id===id);
      document.querySelectorAll('.chip').forEach(c=>c.setAttribute('aria-pressed','false'));
      const idx = planets.findIndex(x=>x.id===id);
      planetList.children[idx].setAttribute('aria-pressed','true');
      renderFacts(selectedPlanet);
      equipSection.setAttribute('aria-disabled','false');
      btnTest.disabled = false;
      statusDot.style.background = 'var(--accent)';
      statusText.textContent = `Pianeta selezionato: ${selectedPlanet.name}. Ora scegli l'equipaggiamento e prova l'atterraggio.`;
      clearResult();
    }

    function renderFacts(p){
      factsBox.innerHTML = '';
      const entries = [
        {k:'Gravità',v:p.g},
        {k:'Atmosfera',v:p.atm},
        {k:'Temperatura',v:p.temp},
        {k:'Pressione',v:p.pressure},
        {k:'Meteo',v:p.wind},
      ];
      entries.forEach(e=>{
        const div = document.createElement('div');
        div.className='fact';
        div.innerHTML = `<b>${e.k}</b>${e.v}`;
        factsBox.appendChild(div);
      });
      p.facts.forEach(f=>{
        const div = document.createElement('div');
        div.className='fact';
        div.innerHTML = f;
        factsBox.appendChild(div);
      })
    }

    function readGear(){
      const ids = [
        'pressLow','pressMed','pressHigh','cool','heat','acid','dust','rad','o2',
        'heatshield','parachute','retro','landingLegs','float'
      ];
      const gear = {};
      ids.forEach(id=> gear[id] = document.getElementById(id).checked );
      return gear;
    }

    function validate(planet, gear){
      // Rules: must include all required true flags, plus at least one suit option present in list
      const req = planet.requires;
      let ok = true;
      const missing = [];
      // Landing systems
      ['heatshield','parachute','retro','landingLegs','float'].forEach(tag=>{
        if(req[tag]){ if(!gear[tag]){ ok=false; missing.push(tag); } }
      });
      // Suit tier
      if(req.suit && req.suit.length){
        const hasSuit = req.suit.some(id=>gear[id]);
        if(!hasSuit){ ok=false; missing.push('tuta corretta'); }
      }
      // Environmental extras
      (req.env||[]).forEach(tag=>{ if(!gear[tag]){ ok=false; missing.push(tag); } });
      return {ok, missing};
    }

    function showResult(ok, missing){
      const svg = stage.querySelector('svg');
      const skull = '💀';
      resultBox.style.display = 'block';
      if(ok){
        svg.classList.remove('fall');
        svg.classList.add('stand');
        resultBox.className = 'result ok';
        resultBox.innerHTML = `✅ Atterraggio riuscito su <b>${selectedPlanet.name}</b>! L'astronauta rimane in piedi.`;
        statusDot.style.background = 'var(--ok)';
        statusText.textContent = 'Missione riuscita!';
        helmetShield.setAttribute('opacity', '0.25');
      } else {
        svg.classList.remove('stand');
        svg.classList.add('fall');
        resultBox.className = 'result bad';
        const pretty = missing.map(m=>prettyName(m)).join(', ');
        resultBox.innerHTML = `❌ Fallito: equipaggiamento insufficiente (${pretty}). L'astronauta cade a terra ${skull}`;
        statusDot.style.background = 'var(--bad)';
        statusText.textContent = 'Equipaggiamento errato: riprova!';
        helmetShield.setAttribute('opacity', '0');
      }
    }

    function prettyName(key){
      const map = {
        pressLow:'tuta bassa pressione',
        pressMed:'tuta media pressione',
        pressHigh:'tuta alta pressione',
        cool:'raffreddamento',
        heat:'riscaldamento',
        acid:'rivestimento anti-acido',
        dust:'filtri antipolvere',
        rad:'schermo radiazioni',
        o2:'riserva O₂',
        heatshield:'scudo termico',
        parachute:'paracadute',
        retro:'retrorazzi',
        landingLegs:'gambe atterraggio',
        float:'modulo flottante',
      };
      return map[key] || key;
    }

    btnTest.addEventListener('click',()=>{
      if(!selectedPlanet){ return; }
      const gear = readGear();
      const res = validate(selectedPlanet, gear);
      showResult(res.ok, res.missing);
    });

    btnReset.addEventListener('click',()=>{
      document.querySelectorAll('input[type="checkbox"]').forEach(i=>i.checked=false);
      document.querySelectorAll('.chip').forEach(c=>c.setAttribute('aria-pressed','false'));
      selectedPlanet = null;
      factsBox.innerHTML='';
      clearResult();
      btnTest.disabled = true;
      equipSection.setAttribute('aria-disabled','true');
      statusDot.style.background = 'var(--warning)';
      statusText.textContent = "Seleziona un pianeta, poi scegli l'equipaggiamento.";
      stage.querySelector('svg').classList.remove('fall','stand');
      helmetShield.setAttribute('opacity', '0');
    });

    function clearResult(){
      resultBox.style.display = 'none';
      resultBox.className = 'result';
      resultBox.innerHTML = '';
    }

    // Accessibility: tap anywhere on stage toggles helmet shield visual
    stage.addEventListener('click',()=>{
      const cur = helmetShield.getAttribute('opacity');
      helmetShield.setAttribute('opacity', cur==='0'?'0.25':'0');
    });

    // Initial planet preselect for quick demo
    selectPlanet('mars');
    document.getElementById('pressMed').checked = true;
    document.getElementById('dust').checked = true;
    document.getElementById('heat').checked = true;
    document.getElementById('o2').checked = true;
    document.getElementById('rad').checked = true;
    document.getElementById('heatshield').checked = true;
    document.getElementById('parachute').checked = true;
    document.getElementById('retro').checked = true;
    document.getElementById('landingLegs').checked = true;
  </script>
</body>
</html>



